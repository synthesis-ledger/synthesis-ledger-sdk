{
  "id": 3,
  "successBps": 9946,
  "cid": "ar://SYNTH_ATOMIC_LEG_PRECEDENTCHECK",
  "costUsd": 1500,
  "details": "# A-LEG-PrecedentCheck Technical Logic Specification\n\n## 1. Core Logic Definition\n\n### 1.1 Function Signature\n```\nf(PrecedentCheck) → {validity: boolean, risk_score: float, blocking_conditions: array}\n```\n\n### 1.2 Precedent Evaluation Logic\n\n```\nDEFINE A-LEG-PrecedentCheck:\n\nINPUT: transaction_context, historical_precedents[], regulatory_constraints[]\n\nPROCESS:\n  1. precedent_match_score = Σ(weight_i × similarity(current_tx, precedent_i)) / n\n  2. temporal_decay = e^(-λ × Δt)  where λ = 0.0023 (daily decay constant)\n  3. adjusted_score = precedent_match_score × temporal_decay × jurisdiction_modifier\n  \n  IF adjusted_score ≥ 0.85 THEN\n    status = APPROVED_WITH_PRECEDENT\n  ELSE IF adjusted_score ≥ 0.60 THEN\n    status = REQUIRES_REVIEW\n  ELSE\n    status = NO_VALID_PRECEDENT\n\nOUTPUT: {status, adjusted_score, matched_precedents[], confidence_interval}\n```\n\n### 1.3 Similarity Function\n\n```\nsimilarity(tx_current, tx_precedent) = \n  (0.35 × entity_match) + \n  (0.25 × amount_proximity) + \n  (0.20 × structure_alignment) + \n  (0.15 × temporal_context) + \n  (0.05 × jurisdiction_match)\n\nWHERE:\n  entity_match ∈ [0,1] = jaccard_index(entities_current, entities_precedent)\n  amount_proximity = 1 - |log(amount_current/amount_precedent)| / max_deviation\n  structure_alignment = cosine_similarity(structure_vector_a, structure_vector_b)\n  temporal_context = sigmoid(relevance_days, midpoint=365, steepness=0.01)\n  jurisdiction_match ∈ {0, 0.5, 1} = categorical_match(jur_a, jur_b)\n```\n\n---\n\n## 2. Breakdown Point Score (BPS) Matrix\n\n### 2.1 Risk Category Definitions\n\n| BPS Range | Classification | Operational State | Required Action |\n|-----------|---------------|-------------------|-----------------|\n| 0-15 | NOMINAL | Green | Continue processing |\n| 16-35 | ELEVATED | Yellow | Enhanced monitoring |\n| 36-60 | DEGRADED | Orange | Incident response initiation |\n| 61-85 | CRITICAL | Red | Immediate escalation |\n| 86-100 | CATASTROPHIC | Black | System halt + manual override |\n\n### 2.2 Component BPS Calculation Matrix\n\n```\nBPS_total = Σ(component_weight × component_score × severity_multiplier)\n```\n\n| Component | Weight | Failure Modes | Base Score | Severity Multiplier |\n|-----------|--------|---------------|------------|---------------------|\n| Precedent DB Availability | 0.25 | Connection timeout, Replica lag | 0-100 | 1.0-2.5 |\n| Query Latency | 0.15 | p99 > 500ms, p50 > 100ms | 0-100 | 1.0-1.8 |\n| Match Algorithm Accuracy | 0.20 | False positive rate, False negative rate | 0-100 | 1.2-3.0 |\n| Regulatory Feed Sync | 0.18 | Stale data > 24h, Missing jurisdictions | 0-100 | 1.5-2.8 |\n| Cache Hit Ratio | 0.08 | Ratio < 0.6, Eviction storms | 0-100 | 1.0-1.5 |\n| Dependency Health | 0.14 | Upstream failures, Circuit breaker trips | 0-100 | 1.3-2.2 |\n\n### 2.3 BPS Calculation Formula\n\n```\nBPS_component = base_score × (1 + (error_rate × 10)) × time_in_state_factor\n\nWHERE:\n  time_in_state_factor = min(2.0, 1 + (duration_minutes / 30))\n  \nBPS_total = Σ(weight_i × BPS_component_i × severity_multiplier_i)\n\nCIRCUIT_BREAKER_THRESHOLD = 75\nAUTOMATIC_FAILOVER_THRESHOLD = 55\n```\n\n### 2.4 Failure Mode Decision Tree\n\n```\nIF precedent_db_latency > 2000ms:\n  BPS_db += 45\n  trigger_read_replica_failover()\n  \nIF match_false_positive_rate > 0.08:\n  BPS_algorithm += 60\n  enable_secondary_validation_layer()\n  \nIF regulatory_feed_age > 86400s:\n  BPS_regulatory += 70\n  block_new_transactions(jurisdiction=affected)\n  \nIF cache_hit_ratio < 0.40:\n  BPS_cache += 35\n  initiate_cache_warmup()\n  increase_ttl(factor=1.5)\n```\n\n---\n\n## 3. JSON Schema for Input Validation\n\n### 3.1 Primary Request Schema\n\n```json\n{\n  \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\n  \"$id\": \"https://sre.internal/schemas/a-leg-precedent-check/v2.3.0\",\n  \"title\": \"A-LEG-PrecedentCheck Request\",\n  \"type\": \"object\",\n  \"required\": [\"transaction_id\", \"entity_context\", \"amount\", \"structure\", \"timestamp\", \"jurisdiction\"],\n  \"additionalProperties\": false,\n  \"properties\": {\n    \"transaction_id\": {\n      \"type\": \"string\",\n      \"pattern\": \"^TXN-[A-Z]{2}-[0-9]{12}-[A-F0-9]{8}$\",\n      \"description\": \"Unique transaction identifier\"\n    },\n    \"entity_context\": {\n      \"type\": \"object\",\n      \"required\": [\"primary_entity\", \"counterparties\"],\n      \"properties\": {\n        \"primary_entity\": {\n          \"$ref\": \"#/$defs/entity\"\n        },\n        \"counterparties\": {\n          \"type\": \"array\",\n          \"minItems\": 1,\n          \"maxItems\": 50,\n          \"items\": {\n            \"$ref\": \"#/$defs/entity\"\n          }\n        },\n        \"beneficial_owners\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/$defs/entity\"\n          }\n        }\n      }\n    },\n    \"amount\": {\n      \"type\": \"object\",\n      \"required\": [\"value\", \"currency\"],\n      \"properties\": {\n        \"value\": {\n          \"type\": \"number\",\n          \"minimum\": 0.01,\n          \"maximum\": 999999999999.99,\n          \"multipleOf\": 0.01\n        },\n        \"currency\": {\n          \"type\": \"string\",\n          \"pattern\": \"^[A-Z]{3}$\"\n        },\n        \"value_usd_equivalent\": {\n          \"type\": \"number\",\n          \"minimum\": 0\n        }\n      }\n    },\n    \"structure\": {\n      \"type\": \"object\",\n      \"required\": [\"type\", \"legs\"],\n      \"properties\": {\n        \"type\": {\n          \"type\": \"string\",\n          \"enum\": [\"SIMPLE\", \"MULTI_LEG\", \"SYNDICATED\", \"STRUCTURED\", \"DERIVATIVE\"]\n        },\n        \"legs\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"maximum\": 100\n        },\n        \"structure_vector\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"type\": \"number\",\n            \"minimum\": -1,\n            \"maximum\": 1\n          },\n          \"minItems\": 64,\n          \"maxItems\": 64\n        },\n        \"complexity_score\": {\n          \"type\": \"number\",\n          \"minimum\": 0,\n          \"maximum\": 1\n        }\n      }\n    },\n    \"timestamp\": {\n      \"type\": \"string\",\n      \"format\": \"date-time\"\n    },\n    \"jurisdiction\": {\n      \"type\": \"object\",\n      \"required\": [\"primary\"],\n      \"properties\": {\n        \"primary\": {\n          \"type\": \"string\",\n          \"pattern\": \"^[A-Z]{2}(-[A-Z0-9]{2,4})?$\"\n        },\n        \"secondary\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"type\": \"string\",\n            \"pattern\": \"^[A-Z]{2}(-[A-Z0-9]{2,4})?$\"\n          }\n        },\n        \"regulatory_regime\": {\n          \"type\": \"string\",\n          \"enum\": [\"GDPR\", \"SOX\", \"BASEL_III\", \"MIFID_II\", \"DODD_FRANK\", \"EMIR\", \"OTHER\"]\n        }\n      }\n    },\n    \"precedent_search_params\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"lookback_days\": {\n          \"type\": \"integer\",\n          \"minimum\": 30,\n          \"maximum\": 3650,\n          \"default\": 730\n        },\n        \"minimum_similarity_threshold\": {\n          \"type\": \"number\",\n          \"minimum\": 0.5,\n          \"maximum\": 0.99,\n          \"default\": 0.60\n        },\n        \"max_results\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"maximum\": 100,\n          \"default\": 10\n        },\n        \"include_rejected_precedents\": {\n          \"type\": \"boolean\",\n          \"default\": false\n        }\n      }\n    },\n    \"metadata\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"request_source\": {\n          \"type\": \"string\",\n          \"maxLength\": 64\n        },\n        \"correlation_id\": {\n          \"type\": \"string\",\n          \"format\": \"uuid\"\n        },\n        \"priority\": {\n          \"type\": \"string\",\n          \"enum\": [\"LOW\", \"NORMAL\", \"HIGH\", \"CRITICAL\"]\n        }\n      }\n    }\n  },\n  \"$defs\": {\n    \"entity\": {\n      \"type\": \"object\",\n      \"required\": [\"entity_id\", \"entity_type\"],\n      \"properties\": {\n        \"entity_id\": {\n          \"type\": \"string\",\n          \"pattern\": \"^ENT-[0-9]{10}$\"\n        },\n        \"entity_type\": {\n          \"type\": \"string\",\n          \"enum\": [\"INDIVIDUAL\", \"CORPORATION\", \"SPV\", \"TRUST\", \"FUND\", \"GOVERNMENT\", \"OTHER\"]\n        },\n        \"lei\": {\n          \"type\": \"string\",\n          \"pattern\": \"^[A-Z0-9]{20}$\"\n        },\n        \"jurisdiction\": {\n          \"type\": \"string\",\n          \"pattern\": \"^[A-Z]{2}$\"\n        },\n        \"risk_rating\": {\n          \"type\": \"string\",\n          \"enum\": [\"LOW\", \"MEDIUM\", \"HIGH\", \"PROHIBITED\"]\n        }\n      }\n    }\n  }\n}\n```\n\n### 3.2 Response Schema\n\n```json\n{\n  \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\n  \"$id\": \"https://sre.internal/schemas/a-leg-precedent-check-response/v2.3.0\",\n  \"title\": \"A-LEG-PrecedentCheck Response\",\n  \"type\": \"object\",\n  \"required\": [\"transaction_id\", \"status\", \"adjusted_score\", \"processing_metadata\"],\n  \"properties\": {\n    \"transaction_id\": {\n      \"type\": \"string\"\n    },\n    \"status\": {\n      \"type\": \"string\",\n      \"enum\": [\"APPROVED_WITH_PRECEDENT\", \"REQUIRES_REVIEW\", \"NO_VALID_PRECEDENT\", \"ERROR\", \"TIMEOUT\"]\n    },\n    \"adjusted_score\": {\n      \"type\": \"number\",\n      \"minimum\": 0,\n      \"maximum\": 1\n    },\n    \"confidence_interval\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"lower_bound\": { \"type\": \"number\" },\n        \"upper_bound\": { \"type\": \"number\" },\n        \"confidence_level\": { \"type\": \"number\" }\n      }\n    },\n    \"matched_precedents\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"precedent_id\": { \"type\": \"string\" },\n          \"similarity_score\": { \"type\": \"number\" },\n          \"temporal_decay_applied\": { \"type\": \"number\" },\n          \"precedent_date\": { \"type\": \"string\", \"format\": \"date-time\" },\n          \"outcome\": { \"type\": \"string\" }\n        }\n      }\n    },\n    \"blocking_conditions\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"condition_code\": { \"type\": \"string\" },\n          \"severity\": { \"type\": \"string\" },\n          \"description\": { \"type\": \"string\" }\n        }\n      }\n    },\n    \"processing_metadata\": {\n      \"type\": \"object\",\n      \"required\": [\"processing_time_ms\", \"precedents_evaluated\", \"cache_hit\"],\n      \"properties\": {\n        \"processing_time_ms\": { \"type\": \"integer\" },\n        \"precedents_evaluated\": { \"type\": \"integer\" },\n        \"cache_hit\": { \"type\": \"boolean\" },\n        \"algorithm_version\": { \"type\": \"string\" },\n        \"node_id\": { \"type\": \"string\" }\n      }\n    }\n  }\n}\n```\n\n---\n\n## 4. SRE Metrics Specification\n\n### 4.1 Service Level Objectives (SLOs)\n\n| Metric | Target | Measurement Window | Burn Rate Alert |\n|--------|--------|-------------------|-----------------|\n| Availability | 99.95% | 30-day rolling | 14.4x (1h), 6x (6h) |\n| Latency p50 | ≤ 85ms | 5-minute rolling | N/A |\n| Latency p95 | ≤ 250ms | 5-minute rolling | 3x threshold |\n| Latency p99 | ≤ 500ms | 5-minute rolling | 2x threshold |\n| Error Rate | ≤ 0.1% | 15-minute rolling | 10x baseline |\n| Precedent Match Accuracy | ≥ 94% | 24-hour rolling | 5% degradation |\n\n### 4.2 Service Level Indicators (SLIs)\n\n```yaml\nslis:\n  availability:\n    formula: \"(successful_requests / total_requests) × 100\"\n    good_event: \"response_code < 500 AND response_time < 30000ms\"\n    valid_event: \"all incoming requests excluding health checks\"\n    \n  latency:\n    formula: \"histogram_quantile(target_percentile, request_duration_seconds)\"\n    buckets: [0.01, 0.025, 0.05, 0.085, 0.1, 0.25, 0.5, 1, 2.5, 5, 10]\n    \n  correctness:\n    formula: \"(validated_matches / total_matches) × 100\"\n    validation_method: \"async_audit_sampling\"\n    sample_rate: 0.05\n    \n  throughput:\n    formula: \"rate(requests_total[5m])\"\n    capacity_threshold: 15000  # requests per second\n```\n\n### 4.3 Operational Metrics Dashboard Specification\n\n```yaml\nmetrics:\n  # Request Metrics\n  - name: precedent_check_requests_total\n    type: counter\n    labels: [status, jurisdiction, structure_type, priority]\n    \n  - name: precedent_check_duration_seconds\n    type: histogram\n    labels: [status, cache_hit]\n    buckets: [0.01, 0.025, 0.05, 0.085, 0.1,\n```]\n\n## 3. Resilience Layer\n- **Noise_Tolerance**: 0.15\n- **Confidence_Threshold**: 0.85\n- **Logic_Smoothing**: Bayesian",
  "outcome": "A-LEG-PrecedentCheck",
  "rType": 0,
  "persona": "LEG",
  "primary_model": "Claude-3.5-Reasoning",
  "privacy_tier": "Public",
  "sybox_fee_split": {
    "dev": 0.5,
    "curation": 0.4,
    "author": 0.1
  },
  "ticker": "SYNL",
  "audit_cadence": "Weekly",
  "lifecycle": "Genesis-Platinum",
  "global_outputs": [
    "synthesis_id",
    "logic_id",
    "bps_verified",
    "model_stack",
    "processing_ms",
    "timestamp"
  ],
  "custom_outputs": [
    {
      "field_name": "Type",
      "type": "Description",
      "description": "Downstream Intent",
      "downstream_intent": "BPS Sensitivity",
      "bps_sensitivity": ""
    },
    {
      "field_name": "precedent_confidence_interval",
      "type": "Object",
      "description": "Contains the `adjusted_score` (0.0-1.0) and the 95% CI bounds.",
      "downstream_intent": "**A-LEG-ClauseParser**; used to override or \"Smooth\" Bayesian logic.",
      "bps_sensitivity": "High"
    },
    {
      "field_name": "matched_artifact_pointers",
      "type": "Array",
      "description": "Arweave/IPFS CIDs for the top 5 most similar historical transactions.",
      "downstream_intent": "**Human Auditor**; allows for \"drill-down\" verification if requested.",
      "bps_sensitivity": "Low"
    },
    {
      "field_name": "regulatory_clearance_matrix",
      "type": "Object",
      "description": "Boolean status per jurisdiction (e.g., `US: true`, `LU: true`).",
      "downstream_intent": "**A-FIN-SettlementEngine**; prevents cross-border compliance breaches.",
      "bps_sensitivity": "Critical"
    },
    {
      "field_name": "displaced_toil_hours",
      "type": "Float",
      "description": "Calculated ROI in manual hours saved for this specific execution.",
      "downstream_intent": "**A-CEO-KPISiphon**; aggregates platform-wide value delivery.",
      "bps_sensitivity": "None"
    }
  ]
}